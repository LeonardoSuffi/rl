<!---->
<script>
    function getParameterByName(name) {
    name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
    let regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
      results = regex.exec(location.search);
    return results === null
      ? ""
      : decodeURIComponent(results[1].replace(/\+/g, " "));
  }
  
    document.querySelector('#leo').addEventListener('submit', function() {
      event.preventDefault();
    let endpointHash =
      "https://app.pipe.run/webservice/integradorJson?hash=a1f5da7e-4346-49ea-a17d-ebaca4443b3d";
    let name = document.querySelector(".nome").value;
    let email = document.querySelector(".email").value;
    let phone = document.querySelector(".tel").value;
    let cidade = document.querySelector(".cidade").value;
    let utm_source = getParameterByName("utm_source");
    let utm_medium = getParameterByName("utm_medium");
    let utm_campaign = getParameterByName("utm_campaign");
    
  
    function configPost(method, body) {
      return {
        method: method,
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(body),
      };
    }
  
    let rules = {
      update: true,
      filter_status_update: "open",
      status: "open",
    };
  
    let lead = [
      {
        id: phone,
        "title": name.toUpperCase() + " - " + cidade.toUpperCase(),
        mobile_phone: phone,
        name: name,
        city_name: cidade,
        email: email,
        last_conversion: {
          source: "Franquia Site",
        },
        custom_fields: {
            url_conversao: location.href,
            utm_source: utm_source,
            utm_medium: utm_medium,
            utm_campaign: utm_campaign,
        },
      },
    ];
  
      let dataToSend = {
        rules: rules,
        leads: lead,
      };

      fetch(endpointHash, configPost("POST", dataToSend))
  .then((data) => {
    document.getElementById('leo').style.display = 'none';
    mensagemObrigado.style.display = 'block';
    gtag_report_conversion();
  });
  
    });
    </script>

  <script>
    function gtag_report_conversion(url) {
      var callback = function () {
        if (typeof(url) != 'undefined') {
          window.location = url;
        }
      };
      gtag('event', 'conversion', {
          'send_to': 'AW-11474129642/xPNaCI-fn4kZEOqlpd8q',
          'event_callback': callback
      });
      return false;
    }
    </script>
    